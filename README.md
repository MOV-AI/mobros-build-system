![image](https://user-images.githubusercontent.com/84147256/138106940-dbe34e71-7c07-4912-a418-e549f7892ecc.png)

# mobros - Movai Object Builder for ROS
Python framework to enable building and packaging of MOV.AI ROS components.

**main branch:**

[![Deploy - On branch main/release Push](https://github.com/MOV-AI/mobros-build-system/actions/workflows/DeployOnMergeMain.yml/badge.svg)](https://github.com/MOV-AI/mobros-build-system/actions/workflows/DeployOnMergeMain.yml)

## How to install mobros
Simply execute the following:
```
python3 -m pip install -i https://artifacts.cloud.mov.ai/repository/pypi-edge/simple --extra-index-url https://pypi.org/simple mobros
```

**Warning:** If you see a warning that the installation folder is not on path simply add it to the PATH env var. 


## How to use mobros
To use, simply install the mobros python package, and use as following:

```
mobros <command> <args>
```


*command* can take following values:

- *build*: to build your ROS workspace.    
- *pack*: to generate debian packages based on the configuration found in all package.xml.

### mobros command: build

Example of usage:
```
mobros build
```

mobros build will install the requirements defined in your ROS component's package.xml and execute a catkin build in the working directory where you are executing mobros.

### mobros command: pack

Example of usage:
```
mobros pack --workspace=/opt/mov.ai/user/cache/ros/src
```

mobros pack will drilldown on your workspace looking for package.xmls. For each package.xml it will generate a ros package (.deb). 
If the ROS component has a `movai_metadata` folder close by, it will be included in the debian package.
Then, on installation, the `movai_metadata` will be automatically imported in MOV.AI database

### mobros command: publish

Example of usage:
```
mobros publish
```

mobros publish is used by the CI systems to patch the rosdep source file with the new generated packages. It uses the yaml file generated by the mobros pack, and sends it to the rosdep patcher service.

**Note:** This command is protected by aws credentials, meaning its usage is limited to CI systems. For edge cases contact the Devops team for the following credentials.
Required environment variables:
 - AWS_DEFAULT_REGION
 - AWS_ACCESS_KEY_ID
 - AWS_SECRET_ACCESS_KEY
