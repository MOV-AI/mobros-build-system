[tox]
# the Python versions in which the tests will be executed, currently only Python3.8
envlist = py38

[testenv]
# the requirements to be installed in the environment in which the tests
allowlist_externals = /usr/bin/sudo
                    /usr/bin/apt-get
                    /usr/bin/ls
                    /usr/bin/cp
basepython = python3.8
# will be executed
deps = -rbuild-requirements.txt
# test command to execute
commands =
    cp -r /usr/lib/python3/dist-packages/apt .tox/py38/lib/python3.8/site-packages/
    
    #if you are using a different python, switch 38 <--- to your python version. for example: apt_pkg.cpython-310-x86_64-linux-gnu.so
    cp /usr/lib/python3/dist-packages/apt_pkg.cpython-38-x86_64-linux-gnu.so .tox/py38/lib/python3.8/site-packages/apt_pkg.so
    cp /usr/lib/python3/dist-packages/apt_inst.cpython-38-x86_64-linux-gnu.so .tox/py38/lib/python3.8/site-packages/apt_inst.so
    #cp /usr/lib/python3/dist-packages/apt_pkg.so .tox/py38/lib/python3.8/site-packages/
    python3.8 -m pytest tests/ --cov=mobros --cov-report=term --cov-report=xml

[pytest]
pythonpath = .

[coverage:run]
# report with relative paths (needed for SonarCloud)
relative_files = True
# report branching coverage
branch = True
